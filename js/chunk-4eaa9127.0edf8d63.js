(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4eaa9127"],{"01ae":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAeCAYAAACBkybCAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGRJREFUeNrszzEJgFAYhdFfsYEVnF0FJ7u4OZtBMMpLYQcnIxjBUTu8QXicD+564VTjnI7IqO/a2Jch5yKe84p73SK35tsUhVRHQcHAwMDAwMDAwMDAwMDAwMDAwMDAwPzSK8AAi4YIlhzgUvQAAAAASUVORK5CYII="},"1c94":function(t,e,i){t.exports=i.p+"img/successful.47d4eb3f.gif"},"1df6":function(t,e,i){},"26b5":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wine-details-container"},[i("div",{staticClass:"wine-details-head"},[i("div",{staticClass:"back-market"},[i("router-link",{attrs:{to:"/tradingdesk"}},[t._v(" < ")])],1),i("v-row",{staticClass:"first-row"},[i("v-flex",{staticClass:"wine-details-wine col-sm-3"},[t._v(t._s(t.wineInfo.wine.vintage)+" "+t._s(t.wineInfo.wine.producer))]),i("v-flex",{staticClass:"wine-details-trade col-sm-1"},[t._v("€5200")]),i("v-flex",{staticClass:"wine-details-change col-sm-1 positive",attrs:{"col-sm1":""}},[t._v("+10.05%")])],1),i("v-row",{staticClass:"second-row"},[i("v-flex",{staticClass:"wine-details-wine-title col-sm-3"},[t._v(t._s(t.wineInfo.wine.regionName)+" / Size "+t._s(t.wineInfo.size)+"l")]),i("v-flex",{staticClass:"wine-details-trade-title col-sm-1"},[t._v("Last trade")]),i("v-flex",{staticClass:"wine-details-change-title col-sm-1"},[t._v("Change")])],1)],1),i("v-container",{staticClass:"grey lighten-5 wine-details-info"},[i("v-flex",[i("div",{staticClass:"description-title"},[t._v("Market")]),i("div",{staticClass:"description-title"},[t._v("Investments")]),i("div",{staticClass:"description-title"},[t._v("Orders")]),i("Orders"),i("div",{staticClass:"description-title"},[t._v("Description")]),i("v-layout",[i("v-flex",{staticClass:"rating-item"},[i("div",{staticClass:"rating-title"},[t._v("RP")]),i("div",{staticClass:"rating-value"},[t._v(t._s(t.wineInfo.wine.rp||0)+"/100")])]),i("v-flex",{staticClass:"rating-item"},[i("div",{staticClass:"rating-title"},[t._v("NM")]),i("div",{staticClass:"rating-value"},[t._v(t._s(t.wineInfo.wine.rp||0)+"/100")])]),i("v-flex",{staticClass:"rating-item"},[i("div",{staticClass:"rating-title"},[t._v("WS")]),i("div",{staticClass:"rating-value"},[t._v(t._s(t.wineInfo.wine.rp||0)+"/100")])]),i("v-flex",{staticClass:"rating-item"},[i("div",{staticClass:"rating-title"},[t._v("JR")]),i("div",{staticClass:"rating-value"},[t._v(t._s(t.wineInfo.wine.rp||0)+"/100")])]),i("v-flex",{staticClass:"rating-item"},[i("div",{staticClass:"rating-title"},[t._v("AG")]),i("div",{staticClass:"rating-value"},[t._v(t._s(t.wineInfo.wine.rp||0)+"/100")])])],1),i("v-row",{staticClass:"wine-details-shortdesc"},[t._v("\n                "+t._s(t.wineInfo.wine.shortDescription)+"\n            ")])],1)],1),i("v-container",{staticClass:"wine-details-trade"},[i("v-tabs",{staticClass:"order-ticket"},[i("v-tab",[t._v("Buy")]),i("v-tab",[t._v("Sell")]),i("v-tab-item",[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("BuyTicket")],1)],1)],1),i("v-tab-item",[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("SellTicket")],1)],1)],1)],1)],1)],1)},n=[],a=i("2f62"),r=i("63e0"),o=i("94d5"),l=i("e58c"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"buy-ticket-container"},[i("div",{staticClass:"ordertype-container"},[i("label",{staticClass:"label-order-type"},[t._v("Order type")]),i("v-select",{staticClass:"buyticket-filter",attrs:{items:[{label:"Market",id:1,filter:"market"},{label:"Order",id:2,filter:"order"}],"single-line":"","item-text":"label","item-value":"filter"},model:{value:t.selectedFilter,callback:function(e){t.selectedFilter=e},expression:"selectedFilter"}})],1),"market"==t.selectedFilter?i("v-layout",[i("BuyTicketNow")],1):t._e(),"order"==t.selectedFilter?i("v-layout",[i("BuyTicketOrder")],1):t._e()],1)},u=[],d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"buyticket-order-container"},[i("v-card",{staticClass:"bid_card",attrs:{xs12:""}},[i("v-card-text",{staticClass:"bid_row",style:{paddingTop:15,paddingBottom:15}},[i("div",{staticClass:"maxunits-container",attrs:{xs12:""}},[i("integer-plusminus",{attrs:{min:0,max:t.maxUnits,step:1},model:{value:t.unitsCount,callback:function(e){t.unitsCount=e},expression:"unitsCount"}},[i("p",[t._v("UNITS")]),t._v("\n                    "+t._s(t.unitsCount)+"\n                ")])],1),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("INVESTMENTS")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.subTotal)))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("COMMISSION")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.comission)))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("STORAGE")]),i("label",{staticClass:"card_label_bold "},[t._v(" - ")])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("STORAGE FEE")]),i("label",{staticClass:"card_label_bold "},[t._v(" "+t._s(t.currencySign)+"- ")])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("TOTAL COST")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.subTotal)))])])])],1),i("v-btn",{class:0!==t.unitsCount?"buy-btn primary-button":"buy-btn primary-button-dis",attrs:{block:"",btnDisabledBg:{color:"#686b70"},disabled:0===t.unitsCount},on:{click:t.createOrder}},[t._v("\n        BU NOW\n    ")])],1)},m=[],f=i("604d");function v(t){return h(t)||b(t)||_()}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function b(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function h(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function C(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(i,!0).forEach(function(e){O(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function O(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var g={name:"BuyTicketNow",components:{IntegerPlusminus:f["a"]},data:function(){return{currencySign:"€",unitsCount:0,maxUnitsCount:3,modalVisible:!1,isErrors:!1,matchIds:new Set,uniqueCaseIds:[]}},computed:C({},Object(a["c"])({domInfo:o["h"].GET_WINE_DOM,wineDetails:o["h"].GET_SELECTED_WINE_INFO,getWinePortfolio:o["h"].GET_WINE_PORTFOLIO,maxBuyCommission:o["g"].GET_USER_MAX_BUY_COMMISSION,minBuyCommission:o["g"].GET_USER_MIN_BUY_COMMISSION,minSellCommission:o["g"].GET_USER_MIN_SELL_COMMISSION,maxSellCommission:o["g"].GET_USER_MAX_SELL_COMMISSION,buyCommission:o["g"].GET_USER_BUY_COMMISSION,sellCommision:o["g"].GET_USER_SELL_COMMISSION,caseSizeId:o["h"].GET_SELECTED_WINE_CASE,warehouseName:o["h"].GET_WAREHOUSE_NAME}),{comission:function(){if(0===this.subTotal)return 0;var t=0,e=(this.subTotal,this.markup,this.minBuyCommission),i=this.maxBuyCommission;return console.log("min commission is ".concat(e)),console.log("max commission is ".concat(i)),t=this.subTotal/100*this.buyCommission,t>i&&(t=i),t<e&&(t=e),t.toFixed(2)},profit:function(){var t=this,e=0,i=0,s=0;return console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)),this.getWinePortfolio.forEach(function(n){if(0===n.profit){var a=n.currentValue/n.quantity;console.log("in portfolio we have ".concat(n.quantity," items with price ").concat(n.currentValue));for(var r=0;r<n.quantity;r++)s<t.unitsCount&&(e+=a,s++,console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)))}else{var o=n.currentValue-n.profit/n.quantity;console.log("in portfolio we have ".concat(n.quantity," items with price ").concat(n.currentValue)),console.log(n);for(var l=0;l<n.quantity;l++)s<t.unitsCount&&(e+=o,s++,console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)))}}),console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)),this.subTotal-e},total:function(){var t=0;return t=parseFloat(this.subTotal)+parseFloat(this.comission),t},pricesPerUnit:function(){var t=[];if(this.domInfo.length<this.unitsCount)return[];for(var e=0;e<this.unitsCount;e++)t.push(this.domInfo[e].buyPrice);return t},maxUnits:function(){var t=0;return this.domInfo.reduce(function(t,e){return t+e.buyQuantity},t)},subTotal:function(){var t=0,e=0,i=this.domInfo;console.log(this.domInfo);for(var s=0;s<=Object.keys(i).length;s++){var n=i[s];if(!n)break;for(var a=1;a<=n.buyQuantity;a++){if(e>=this.unitsCount||!n.buyQuantity)break;e++,t+=n.buyPrice}}return t}}),methods:{calculateAvaiableUniqueCasesIds:function(){var t=[];return this.getWinePortfolio.forEach(function(e){e.portfolioCases.forEach(function(e){1===e.status&&t.push(e.uniqueCaseId)})}),t},getMatchIds:function(){var t=[];return console.log("match id"),console.log(t),this.domInfo[0].buyOrderId},setModalVisible:function(t){this.modalVisible=t},createOrder:function(){var t=this;this.calculateAvaiableUniqueCasesIds();if(this.uniqueCaseIds=[],this.matchIds.clear(),this.unitsCount>this.maxUnits)Alert.alert("Not enough units in the portfolio","There are only ".concat(this.maxUnits," units"));else{this.domInfo.forEach(function(e){if(null!=e.casesToBuy)for(var i=0;i<e.casesToBuy.length;i++)t.uniqueCaseIds.length!=t.unitsCount&&(t.uniqueCaseIds.push(e.casesToBuy[i]),t.matchIds.add(e.buyOrderId))});var e={type:2,pricePerCase:this.domInfo[0].buyPrice,isBuy:1,barCodes:null,uniqueCasesIds:this.uniqueCaseIds,wineId:this.wineDetails.wine.wineId,matchIds:v(this.matchIds),caseQuantity:this.unitsCount,commission:this.comission,total:this.subTotal,caseSizeId:this.caseSizeId,actionType:"Buy",warehouseName:""};console.log(e),this.$store.dispatch(r["e"].SET_CURRENT_ORDER,e),this.$router.push({path:"/order-confirmation/"})}}}},y=g,I=(i("9a9a"),i("2877")),E=Object(I["a"])(y,d,m,!1,null,"61626663",null),S=E.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"buyticket-order-container"},[i("wineInfo"),i("DomInfo"),i("v-card",{staticClass:"bid_card",attrs:{xs12:""}},[i("v-card-text",{staticClass:"bid_row",style:{paddingTop:15,paddingBottom:15}},[i("div",{staticClass:"maxunits-container",attrs:{xs12:""}},[i("integer-plusminus",{attrs:{min:1,max:1e3,step:1},model:{value:t.unitsCount,callback:function(e){t.unitsCount=e},expression:"unitsCount"}},[i("p",[t._v("UNITS")]),t._v("\n                    "+t._s(t.unitsCount)+"\n                ")])],1),i("div",{staticClass:"price-container",attrs:{xs12:""}},[i("integer-plusminus",{attrs:{min:1,max:1e6,step:10},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}},[i("p",[t._v("PRICE")]),t._v("\n                    "+t._s(t.price)+"\n                ")])],1),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("COMMISSION")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.commission)))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("STORAGE")]),i("label",{staticClass:"card_label_bold "},[t._v(" - ")])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("TOTAL INVESTMENTS")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.subTotal)))])])])],1),i("v-btn",{class:0!==t.unitsCount?"buy-btn primary-button":"buy-btn primary-button-dis",attrs:{block:"",btnDisabledBg:{color:"#686b70"},disabled:0===t.unitsCount},on:{click:t.createOffer}},[t._v("\n        CREATE BID\n    ")])],1)},T=[],x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div")},P=[],M={name:"wineInfoComp"},k=M,N=Object(I["a"])(k,x,P,!1,null,"332ed90c",null),A=N.exports,R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dominfo-container"},[i("v-layout",[t.isDomInfoAvaiable?i("v-flex",{staticClass:"info"},[i("v-row",{staticClass:"info_thead"},[i("v-col",{attrs:{size:1}},[i("v-label",{staticClass:"card_label_thead"},[t._v("BEST OFFERS")])],1),i("v-col",{attrs:{size:1}},[i("v-label",{staticClass:"card_label_thead"},[t._v("UNITS")])],1),i("v-col",{attrs:{size:1}},[i("v-label",{staticClass:"card_label_thead"},[t._v("STORAGE")])],1)],1),t._l(t.domInfo,function(e){return i("v-row",{staticClass:"info_row"},[i("v-col",{attrs:{size:1}},[i("v-label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.zero(e.buyPrice))))])],1),i("v-col",{attrs:{size:1}},[i("v-label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.zero(e.buyQuantity))))])],1),i("v-col",{attrs:{size:1}},[i("v-label",{staticClass:"card_label_bold"},[t._v(t._s(e.warehouseName))])],1)],1)})],2):i("v-layout",{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:15}},[i("v-label",[t._v("There are no offers")])],1)],1)],1)},D=[];function U(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?U(i,!0).forEach(function(e){B(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):U(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function B(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var G={name:"DomInfo",data:function(){return{isDomInfoAvaiable:!1}},watch:{domInfo:{immediate:!0,deep:!0,handler:function(t){var e=this;console.log("updated!"),console.log(this.actionType),console.log(this.domInfo);var i=this.domInfo.filter(function(t){return"Buy"===e.actionType||"Bid"===e.actionType?t.buyPrice>0:t.sellPrice>0});console.log(i),this.isDomInfoAvaiable=i.length>0}}},computed:j({},Object(a["c"])({domInfo:o["h"].GET_WINE_DOM,currencySign:o["b"].GET_CURRENCY_SIGN})),methods:{zero:function(t){return 0===t?"-":t}}},F=G,L=(i("b615"),Object(I["a"])(F,R,D,!1,null,"55430029",null)),q=L.exports;function V(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function W(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?V(i,!0).forEach(function(e){z(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):V(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var $={name:"BuyTicketOrder",components:{wineInfo:A,DomInfo:q,IntegerPlusminus:f["a"]},data:function(){return{currencySign:"€",unitsCount:0,modalVisible:!1,price:100,isErrors:!1,isModalVisible:!1}},computed:W({},Object(a["c"])({wine:o["h"].GET_SELECTED_WINE_INFO,winePortfolio:o["h"].GET_WINE_PORTFOLIO,maxBuyCommission:o["g"].GET_USER_MAX_BUY_COMMISSION,minBuyCommission:o["g"].GET_USER_MIN_BUY_COMMISSION,minSellCommission:o["g"].GET_USER_MIN_SELL_COMMISSION,maxSellCommission:o["g"].GET_USER_MAX_SELL_COMMISSION,buyCommission:o["g"].GET_USER_BUY_COMMISSION,sellCommision:o["g"].GET_USER_SELL_COMMISSION,markup:o["g"].GET_USER_MARKUP_COMMISSION,maxMarkup:o["g"].GET_USER_MAX_MARKUP_COMMISSION,minMarkup:o["g"].GET_USER_MIN_MARKUP_COMMISSION,caseSizeId:o["h"].GET_SELECTED_WINE_CASE,warehouseName:o["h"].GET_WAREHOUSE_NAME}),{subTotal:function(){if(this.price*this.unitsCount>0){var t=0,e=this.minBuyCommission,i=this.maxBuyCommission;return t=this.price*this.unitsCount/100*this.buyCommission,t>i&&(t=i),t<e&&(t=e),this.price*this.unitsCount+t}return 0},markupComission:function(){if(0===this.unitsCount)return 0;var t=0;return t+=this.price/100*this.markup,t>this.maxMarkup&&(t=this.maxMarkup),t<this.minMarkup&&(t=this.minMarkup),console.log("markup commission is ".concat(t)),t},total:function(){return parseFloat(this.subTotal)},commission:function(){var t=0;if(this.price*this.unitsCount===0)return 0;console.log("min buy commission is ".concat(this.minBuyCommission," and max buy commission is ").concat(this.maxBuyCommission)),console.log("min sell commission is ".concat(this.minSellCommission," and max sell commission is ").concat(this.maxSellCommission));var e=this.minBuyCommission,i=this.maxBuyCommission;return console.log("min commission is ".concat(e)),console.log("max commission is ".concat(i)),t=this.price*this.unitsCount/100*this.buyCommission,t>i&&(t=i),t<e&&(t=e),t.toFixed(2)}}),methods:{calculateAvaiableUniqueCasesIds:function(){var t=[];return this.winePortfolio.forEach(function(e){e.portfolioCases.forEach(function(e){1===e.status&&t.push(e.uniqueCaseId)})}),t},setModalVisible:function(t){this.modalVisible=t},createOffer:function(){var t=this,e=this.calculateAvaiableUniqueCasesIds();console.log("avaiable uniques -> "+e);var i=function(){var e=[];if(t.winePortfolio.length)for(var i=t.winePortfolio[0],s=0;s<=t.unitsCount-1;s++)e.push(i.uniqueCaseIds[s]);return e};console.log(this.caseSizeId),console.log(this.wine);var s={type:1,caseSizeId:"undefined"==typeof this.caseSizeId?this.wine.wine.caseSizeIds:this.caseSizeId,pricePerCase:this.price,isBuy:1,barCodes:null,uniqueCasesIds:i(),wineId:this.wine.wine.wineId,matchIds:null,caseQuantity:this.unitsCount,commission:this.commission,total:this.subTotal,actionType:"Bid",warehouseName:"-"};console.log(s),this.$store.dispatch(r["e"].SET_CURRENT_ORDER,s),this.$router.push({path:"/order-confirmation/"})},confirmOrder:function(){var t=this,e={caseSizeId:this.caseSizeId,type:1,pricePerCase:this.price,isBuy:1,barCodes:null,uniqueCasesIds:null,wineId:this.wine.wine.wineId,matchIds:null,caseQuantity:this.unitsCount};this.$store.dispatch(r["e"].CREATE_ORDER,e).then(function(t){console.log(t)}).catch(function(e){e.data.errors.length>0?console.log(e.data.errors[0].Message):e.data.valiationErrors.length>0&&console.log(t.errorText=e.data.valiationErrors[0].exception.Message)})}}},Y=$,Q=(i("c188"),Object(I["a"])(Y,w,T,!1,null,"13867aa2",null)),X=Q.exports,K={name:"BuyTicket",components:{BuyTicketNow:S,BuyTicketOrder:X},data:function(){return{selectedFilter:"market"}}},J=K,H=(i("97e1"),Object(I["a"])(J,c,u,!1,null,"564379b2",null)),Z=H.exports,tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sell-ticket-container"},[i("div",{staticClass:"ordertype-container"},[i("label",{staticClass:"label-order-type"},[t._v("Order type")]),i("v-select",{staticClass:"buyticket-filter",attrs:{items:[{label:"Market",id:1,filter:"market"},{label:"Order",id:2,filter:"order"}],"single-line":"","item-text":"label","item-value":"filter"},model:{value:t.selectedFilter,callback:function(e){t.selectedFilter=e},expression:"selectedFilter"}})],1),"market"==t.selectedFilter?i("v-layout",[i("SellTicketNow")],1):t._e(),"order"==t.selectedFilter?i("v-layout",[i("SellTicketOrder")],1):t._e()],1)},et=[],it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sellticket-order-container"},[i("v-card",{staticClass:"bid_card",attrs:{xs12:""}},[i("v-card-text",{staticClass:"bid_row",style:{paddingTop:15,paddingBottom:15}},[i("div",{staticClass:"maxunits-container",attrs:{xs12:""}},[i("integer-plusminus",{attrs:{min:0,max:t.maxUnits,step:1},model:{value:t.unitsCount,callback:function(e){t.unitsCount=e},expression:"unitsCount"}},[i("p",[t._v("UNITS")]),t._v("\n                    "+t._s(t.unitsCount)+"\n                ")])],1),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("RETURN")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.subTotal)))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("COMMISSION")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.comission)))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("STORAGE")]),i("label",{staticClass:"card_label_bold "},[t._v(" "+t._s(t.warehouseName))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("STORAGE FEE")]),i("label",{staticClass:"card_label_bold "},[t._v(" "+t._s(t.currencySign)+"- ")])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("TOTAL RETURN")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.subTotal)))])])])],1),i("v-btn",{class:0!==t.unitsCount?"sell-btn primary-button":"sell-btn primary-button-dis",attrs:{block:"",btnDisabledBg:{color:"#686b70"},disabled:0===t.unitsCount},on:{click:t.createOrder}},[t._v("\n        SELL NOW\n    ")])],1)},st=[];function nt(t){return ot(t)||rt(t)||at()}function at(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function rt(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function ot(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function lt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function ct(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?lt(i,!0).forEach(function(e){ut(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):lt(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function ut(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var dt={name:"SellTicketNow",data:function(){return{currencySign:"€",unitsCount:0,maxUnitsCount:3,modalVisible:!1,isErrors:!1,matchIds:new Set,uniqueCaseIds:[]}},components:{IntegerPlusminus:f["a"]},computed:ct({},Object(a["c"])({domInfo:o["h"].GET_WINE_DOM,wineDetails:o["h"].GET_SELECTED_WINE_INFO,getWinePortfolio:o["h"].GET_WINE_PORTFOLIO,maxBuyCommission:o["g"].GET_USER_MAX_BUY_COMMISSION,minBuyCommission:o["g"].GET_USER_MIN_BUY_COMMISSION,minSellCommission:o["g"].GET_USER_MIN_SELL_COMMISSION,maxSellCommission:o["g"].GET_USER_MAX_SELL_COMMISSION,buyCommission:o["g"].GET_USER_BUY_COMMISSION,sellCommision:o["g"].GET_USER_SELL_COMMISSION,caseSizeId:o["h"].GET_SELECTED_WINE_CASE,warehouseName:o["h"].GET_WAREHOUSE_NAME}),{comission:function(){if(0===this.subTotal)return 0;var t=0,e=(this.subTotal,this.markup,this.minBuyCommission),i=this.maxBuyCommission;return console.log("min commission is ".concat(e)),console.log("max commission is ".concat(i)),t=this.subTotal/100*this.sellCommision,t>i&&(t=i),t<e&&(t=e),t.toFixed(2)},profit:function(){var t=this,e=0,i=0,s=0;return console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)),this.getWinePortfolio.forEach(function(n){if(0===n.profit){var a=n.currentValue/n.quantity;console.log("in portfolio we have ".concat(n.quantity," items with price ").concat(n.currentValue));for(var r=0;r<n.quantity;r++)s<t.unitsCount&&(e+=a,s++,console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)))}else{var o=n.currentValue-n.profit/n.quantity;console.log("in portfolio we have ".concat(n.quantity," items with price ").concat(n.currentValue)),console.log(n);for(var l=0;l<n.quantity;l++)s<t.unitsCount&&(e+=o,s++,console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)))}}),console.log("profit ".concat(i)),console.log("totalPortfolio ".concat(e)),console.log("count ".concat(s)),this.subTotal-e},total:function(){var t=0;return t=parseFloat(this.subTotal)-parseFloat(this.comission),t},pricesPerUnit:function(){var t=[];if(this.domInfo.length<this.unitsCount)return[];for(var e=0;e<this.unitsCount;e++)t.push(this.domInfo[e].sellPrice);return t},maxUnits:function(){var t=0,e=this.calculateAvaiableUniqueCasesIds().length,i=this.domInfo.reduce(function(t,e){return t+e.sellQuantity},t);return i<=e?i:e},subTotal:function(){var t=0,e=0,i=this.domInfo;console.log(this.domInfo);for(var s=0;s<=Object.keys(i).length;s++){var n=i[s];if(!n)break;for(var a=1;a<=n.sellQuantity;a++){if(e>=this.unitsCount||!n.sellQuantity)break;e++,t+=n.sellPrice}}return t}}),mounted:function(){},methods:{calculateAvaiableUniqueCasesIds:function(){var t=[];return this.getWinePortfolio.forEach(function(e){e.portfolioCases.forEach(function(e){1===e.status&&t.push(e.uniqueCaseId)})}),t},getMatchIds:function(){var t=[];return console.log("match id"),console.log(t),this.domInfo[0].sellOrderId},setModalVisible:function(t){this.modalVisible=t},createOrder:function(){var t=this.calculateAvaiableUniqueCasesIds();if(this.uniqueCaseIds=[],this.matchIds.clear(),this.unitsCount>this.maxUnits)Alert.alert("Not enough units in the portfolio","There are only ".concat(this.maxUnits," units"));else{this.matchIds.add(this.domInfo[0].sellOrderId);for(var e=0;e<this.unitsCount;e++)this.uniqueCaseIds.push(t[e]);var i={type:2,pricePerCase:this.domInfo[0].sellPrice,isBuy:0,barCodes:null,uniqueCasesIds:this.uniqueCaseIds,wineId:this.wineDetails.wine.wineId,matchIds:nt(this.matchIds),caseQuantity:this.unitsCount,commission:this.comission,total:this.subTotal,caseSizeId:this.caseSizeId,actionType:"Sell",warehouseName:this.warehouseName};console.log(i),this.$store.dispatch(r["e"].SET_CURRENT_ORDER,i),this.navigation.navigate("OrderConfirmation")}}}},mt=dt,ft=(i("3333"),Object(I["a"])(mt,it,st,!1,null,"f5d41890",null)),vt=ft.exports,_t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sellticket-order-container"},[i("wineInfo"),i("v-card",{staticClass:"bid_card",attrs:{xs12:""}},[i("v-card-text",{staticClass:"bid_row",style:{paddingTop:15,paddingBottom:15}},[i("div",{staticClass:"maxunits-container",attrs:{xs12:""}},[i("integer-plusminus",{attrs:{min:1,max:t.maxUnits,step:1},model:{value:t.unitsCount,callback:function(e){t.unitsCount=e},expression:"unitsCount"}},[i("p",[t._v("UNITS")]),t._v("\n                    "+t._s(t.unitsCount)+"\n                ")])],1),i("div",{staticClass:"price-container",attrs:{xs12:""}},[i("integer-plusminus",{attrs:{min:1,max:1e6,step:10},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}},[i("p",[t._v("PRICE")]),t._v("\n                    "+t._s(t.price)+"\n                ")])],1),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("COMMISSION")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.commission)))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("STORAGE")]),i("label",{staticClass:"card_label_bold "},[t._v(t._s(t.warehouseName))])]),i("div",{staticClass:"sellticket-summary-row"},[i("label",{staticClass:"card_label_regular"},[t._v("TOTAL RETURN")]),i("label",{staticClass:"card_label_bold"},[t._v(t._s(t.formatPrice(t.subTotal)))])])])],1),i("v-btn",{class:0!==t.unitsCount?"sell-btn primary-button":"sell-btn primary-button-dis",attrs:{block:"",btnDisabledBg:{color:"#686b70"},disabled:0===t.unitsCount},on:{click:t.createOffer}},[t._v("\n        CREATE OFFER\n    ")])],1)},bt=[];function ht(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function pt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ht(i,!0).forEach(function(e){Ct(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ht(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Ct(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Ot={name:"SellTicketOrder",components:{wineInfo:A,IntegerPlusminus:f["a"]},data:function(){return{currencySign:"€",unitsCount:0,modalVisible:!1,price:100,isErrors:!1,isModalVisible:!1}},computed:pt({},Object(a["c"])({wine:o["h"].GET_SELECTED_WINE_INFO,winePortfolio:o["h"].GET_WINE_PORTFOLIO,maxBuyCommission:o["g"].GET_USER_MAX_BUY_COMMISSION,minBuyCommission:o["g"].GET_USER_MIN_BUY_COMMISSION,minSellCommission:o["g"].GET_USER_MIN_SELL_COMMISSION,maxSellCommission:o["g"].GET_USER_MAX_SELL_COMMISSION,buyCommission:o["g"].GET_USER_BUY_COMMISSION,sellCommision:o["g"].GET_USER_SELL_COMMISSION,markup:o["g"].GET_USER_MARKUP_COMMISSION,maxMarkup:o["g"].GET_USER_MAX_MARKUP_COMMISSION,minMarkup:o["g"].GET_USER_MIN_MARKUP_COMMISSION,caseSizeId:o["h"].GET_SELECTED_WINE_CASE,warehouseName:o["h"].GET_WAREHOUSE_NAME}),{subTotal:function(){if(this.price*this.unitsCount>0){var t=0,e=this.minSellCommission,i=this.maxSellCommission;return t=this.price*this.unitsCount/100*this.sellCommision,t>i&&(t=i),t<e&&(t=e),this.price*this.unitsCount-t}return 0},markupComission:function(){if(0===this.unitsCount)return 0;var t=0;return t+=this.price/100*this.markup,t>this.maxMarkup&&(t=this.maxMarkup),t<this.minMarkup&&(t=this.minMarkup),console.log("markup commission is ".concat(t)),t},total:function(){var t=this,e=0;e=this.subTotal-this.commission;var i=0;return console.log("subTotal ".concat(this.subTotal)),console.log("commission ".concat(this.commission)),console.log("total ".concat(e)),this.winePortfolio.forEach(function(s){if(0===s.profit){var n=s.currentValue/s.quantity;console.log("pricePerCase ".concat(n));var a=n-t.price;console.log("total ".concat(e)),console.log("dif ".concat(a));for(var r=0;r<s.quantity;r++)console.log("roolsadd"),i<t.unitsCount&&(e-=n,i++,console.log("after total ".concat(e)))}else{var o=s.currentValue+s.profit/s.quantity;console.log("pricePerCase ".concat(o));var l=o-t.price;console.log("total ".concat(e)),console.log("dif ".concat(l));for(var c=0;c<s.quantity;c++)console.log("roolsadd"),i<t.unitsCount&&(e-=o,i++,console.log("after total ".concat(e)))}e=t.subTotal}),console.log("total ".concat(e)),e},commission:function(){var t=0;if(this.price*this.unitsCount===0)return 0;var e=this.minSellCommission,i=this.maxSellCommission;return t=this.price*this.unitsCount/100*this.sellCommision,t>i&&(t=i),t<e&&(t=e),t.toFixed(2)},maxUnits:function(){var t=[];return this.winePortfolio.forEach(function(e){e.portfolioCases.forEach(function(e){console.log("rec"),console.log(e),1===e.status&&(t.push(e.uniqueCaseId),console.log(e))})}),console.log("max units -> "+t.length),t.length}}),methods:{calculateAvaiableUniqueCasesIds:function(){var t=[];return this.winePortfolio.forEach(function(e){e.portfolioCases.forEach(function(e){1===e.status&&t.push(e.uniqueCaseId)})}),t},setModalVisible:function(t){this.modalVisible=t},createOffer:function(){var t=this,e=this.calculateAvaiableUniqueCasesIds();console.log("avaiable uniques"),console.log(e);var i=function(){var e=[];if(t.winePortfolio.length)for(var i=t.winePortfolio[0],s=0;s<=t.unitsCount-1;s++)e.push(i.uniqueCaseIds[s]);return e},s={type:1,caseSizeId:this.caseSizeId,pricePerCase:this.price,isBuy:0,barCodes:null,uniqueCasesIds:i(),wineId:this.wine.wine.wineId,matchIds:null,caseQuantity:this.unitsCount,commission:this.commission,total:this.subTotal,actionType:"Offer",warehouseName:this.warehouseName};this.$store.dispatch(r["e"].SET_CURRENT_ORDER,s),this.$router.push({path:"/order-confirmation/"})},confirmOrder:function(){var t=this,e=function(){var e=[];if(t.winePortfolio.length)for(var i=t.winePortfolio[0],s=0;s<=t.unitsCount-1;s++)e.push(i.uniqueCaseIds[s]);return e},i={caseSizeId:this.caseSizeId,type:1,pricePerCase:this.price,isBuy:0,barCodes:null,uniqueCasesIds:e(),wineId:this.wine.wine.wineId,matchIds:null,caseQuantity:this.unitsCount};this.$store.dispatch(r["e"].CREATE_ORDER,i).then(function(t){console.log(t)}).catch(function(e){e.data.errors.length>0?console.log(t.errorText=e.data.errors[0].Message):e.data.valiationErrors.length>0&&console.log(e.data.valiationErrors[0].exception.Message)})}}},gt=Ot,yt=(i("da7a"),Object(I["a"])(gt,_t,bt,!1,null,"291f8a06",null)),It=yt.exports,Et={name:"SellTicket",components:{SellTicketNow:vt,SellTicketOrder:It},data:function(){return{selectedFilter:"market"}}},St=Et,wt=(i("db76"),Object(I["a"])(St,tt,et,!1,null,"433bfc9d",null)),Tt=wt.exports;function xt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function Pt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?xt(i,!0).forEach(function(e){Mt(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):xt(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function Mt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var kt={name:"Winedetails",props:{wineId:String},components:{Orders:l["a"],BuyTicket:Z,SellTicket:Tt},data:function(){return{activeIcon:!1,logged:!0,favouritesLabel:"Add to favourites"}},computed:Pt({},Object(a["c"])({wineInfo:o["h"].GET_SELECTED_WINE_INFO})),created:function(){this.$store.dispatch(r["g"].GET_USER_COMMISSION)}},Nt=kt,At=(i("2a00"),Object(I["a"])(Nt,s,n,!1,null,"35377f2f",null));e["default"]=At.exports},"2a00":function(t,e,i){"use strict";var s=i("a40e"),n=i.n(s);n.a},3333:function(t,e,i){"use strict";var s=i("ee4a"),n=i.n(s);n.a},5748:function(t,e,i){},"5ef6":function(t,e,i){"use strict";var s=i("aec8"),n=i.n(s);n.a},"604d":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"int-pm",class:{"int-pm-vertical":t.vertical}},[i("div",{staticClass:"int-pm-btn",class:t.getBtnClass(!0),on:{click:function(e){t.vertical?t.increment():t.decrement()}}},[t._t(t.vertical?"increment":"decrement",[t._v(t._s(t.vertical?"+":"-"))])],2),i("div",{staticClass:"int-pm-value"},[t._t("default",[t._v(t._s(t.intValue))])],2),i("div",{staticClass:"int-pm-btn",class:t.getBtnClass(!1),on:{click:function(e){t.vertical?t.decrement():t.increment()}}},[t._t(t.vertical?"decrement":"increment",[t._v(t._s(t.vertical?"-":"+"))])],2)])},n=[],a={name:"IntegerPlusminus",props:{value:{default:0,type:Number},min:{default:0,type:Number},max:{default:void 0,type:Number},step:{default:1,type:Number},vertical:{default:!1,type:Boolean}},data:function(){return{intValue:0}},computed:{canIncrement:function(){return void 0===this.max||this.intValue+this.step<=this.max},canDecrement:function(){return this.intValue-this.step>=this.min}},methods:{getBtnClass:function(t){var e="int-pm-";return t&&!this.vertical||!t&&this.vertical?(e+="decrement",this.canDecrement||(e+=" disabled")):(e+="increment",this.canIncrement||(e+=" disabled")),e},increment:function(){this.canIncrement&&(this.intValue=this.intValue+this.step,this.$emit("ipm-increment",this.intValue),this.$emit("input",this.intValue))},decrement:function(){this.canDecrement&&(this.intValue=this.intValue-this.step,this.$emit("ipm-decrement",this.intValue),this.$emit("input",this.intValue))}},watch:{value:{handler:function(t,e){this.intValue=t}}},created:function(){this.intValue=this.value,this.step<1&&(this.step=1),this.max<this.min&&(this.max=void 0)}},r=a,o=(i("5ef6"),i("2877")),l=Object(o["a"])(r,s,n,!1,null,"d186caf0",null),c=l.exports;i.d(e,"a",function(){return c})},"68b6":function(t,e,i){"use strict";var s=i("f905"),n=i.n(s);n.a},"761d":function(t,e,i){"use strict";var s=i("ae17"),n=i.n(s);n.a},8193:function(t,e,i){},"839e":function(t,e,i){},"97e1":function(t,e,i){"use strict";var s=i("b770"),n=i.n(s);n.a},"9a9a":function(t,e,i){"use strict";var s=i("8193"),n=i.n(s);n.a},a40e:function(t,e,i){},ae17:function(t,e,i){},aec8:function(t,e,i){},b615:function(t,e,i){"use strict";var s=i("c0b6"),n=i.n(s);n.a},b770:function(t,e,i){},c0b6:function(t,e,i){},c188:function(t,e,i){"use strict";var s=i("5748"),n=i.n(s);n.a},da7a:function(t,e,i){"use strict";var s=i("839e"),n=i.n(s);n.a},db76:function(t,e,i){"use strict";var s=i("1df6"),n=i.n(s);n.a},e2dc:function(t,e,i){t.exports=i.p+"img/unsuccessful.39735d8c.gif"},e58c:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.modifyOrderDialog,callback:function(e){t.modifyOrderDialog=e},expression:"modifyOrderDialog"}},[s("v-card",[s("v-card-title",[s("span",{staticClass:"headline"},[t._v("Edit Offer")])]),s("v-card-text",{staticClass:"editoffer-container"},[s("v-container",{attrs:{"grid-list-md":""}},[t.editOrderFail.visible||t.editOrderSuccess.visible?t._e():s("v-layout",{attrs:{wrap:""}},[s("v-flex",{attrs:{xs12:""}},[s("span",{staticClass:"display-1 text--primary card_label_name"},[t._v(t._s(t.selectedOrder.producer))]),s("div",{staticClass:"card_item_second"},[s("v-img",{staticClass:"order-country-wine",attrs:{src:i("01ae")}}),s("span",{staticClass:"card_label_regular vintage-label"},[t._v(t._s(t.selectedOrder.vintage))]),s("v-label",{staticClass:"card_label_regular region-label"},[t._v(t._s(t.selectedOrder.region))])],1),s("div",{staticClass:"card_item_third"},[s("v-label",{staticClass:"card_label_regular blue_unit"},[t._v(t._s(t.selectedOrder.units)+" "+t._s(1==t.selectedOrder.units?"UNIT":"UNITS"))]),s("v-label",{staticClass:"card_label_regular blue_unit"},[t._v(" / €"+t._s(t.selectedOrder.price))]),s("v-label",{staticClass:"card_label_regular blue_unit"},[t._v(" x unit")])],1)]),s("v-flex",{attrs:{xs12:""}},[s("v-card",{staticClass:"mx-auto"},[s("v-card-text",[s("v-layout",{staticClass:"text--primary"},[s("v-flex",{attrs:{xs6:""}},[s("integer-plusminus",{attrs:{min:1,max:t.maxUnits,step:1},model:{value:t.units,callback:function(e){t.units=e},expression:"units"}},[s("p",[t._v("UNITS")]),t._v("\n                                                "+t._s(t.units)+"\n                                            ")])],1),s("v-flex",{staticClass:"editorder-price-container",attrs:{xs6:""}},[s("integer-plusminus",{attrs:{min:1,max:1e6,step:10},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}},[s("p",[t._v("PRICE")]),t._v("\n                                                "+t._s(t.price)+"\n                                            ")])],1)],1)],1),s("v-card-actions",[s("v-flex",{staticClass:"editorder-total-investment",attrs:{xs12:""}},[t._v("\n                                        TOTAL INVESTMENTS €"+t._s(t.selectedOrder.price*t.selectedOrder.units)+"\n                                    ")])],1)],1)],1)],1),t.editOrderFail.visible?s("v-card-text",{staticClass:"addaddress-result-container"},[s("v-flex",{staticClass:"deladdress-result-img"},[s("v-img",{attrs:{src:i("e2dc")}})],1),s("v-text",{staticClass:"cancel-order-fail-text"},[t._v(t._s(t.editOrderFail.text))])],1):t._e(),t.editOrderSuccess.visible?s("v-card-text",{staticClass:"addaddress-result-container"},[s("v-flex",{staticClass:"deladdress-result-img"},[s("v-img",{attrs:{src:i("1c94")}})],1),s("v-text",{staticClass:"cancel-order-success-text"},[t._v(t._s(t.editOrderSuccess.text))])],1):t._e()],1)],1),s("v-card-actions",[s("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.modifyOrderDialog=!1}}},[t._v("Close")]),s("v-spacer"),t.editOrderFail.visible||t.editOrderSuccess.visible?t._e():s("v-btn",{staticClass:"sellorder-btn",attrs:{text:""},on:{click:t.editOrder}},[t._v("Confirm Changes")]),t.editOrderFail.visible?s("v-btn",{staticClass:"sellorder-btn",attrs:{text:""},on:{click:t.editOrder}},[t._v("Try Again")]):t._e()],1)],1)],1),s("v-dialog",{attrs:{"max-width":"320px"},model:{value:t.cancelOrderDialog,callback:function(e){t.cancelOrderDialog=e},expression:"cancelOrderDialog"}},[s("v-card",[s("v-card-title",[t._v("Cancel Order")]),t.cancelOrderFail.visible||t.cancelOrderSuccess.visible?t._e():s("v-card-text",{staticClass:"cancel-order-container"},[s("v-container",{attrs:{"grid-list-md":""}},[s("v-layout",{attrs:{wrap:""}},[t._v("\n                        Are you sure you want to cancel this order?\n                    ")])],1)],1),t.cancelOrderFail.visible?s("v-card-text",{staticClass:"addaddress-result-container"},[s("v-flex",{staticClass:"deladdress-result-img"},[s("v-img",{attrs:{src:i("e2dc")}})],1),s("v-text",{staticClass:"cancel-order-fail-text"},[t._v(t._s(t.cancelOrderFail.text))])],1):t._e(),t.cancelOrderSuccess.visible?s("v-card-text",{staticClass:"addaddress-result-container"},[s("v-flex",{staticClass:"deladdress-result-img"},[s("v-img",{attrs:{src:i("1c94")}})],1),s("v-text",{staticClass:"cancel-order-success-text"},[t._v(t._s(t.cancelOrderSuccess.text))])],1):t._e(),s("v-card-actions",[s("v-btn",{staticClass:"close-change-pass-modal",attrs:{color:"blue darken-1",text:""},on:{click:function(e){t.cancelOrderDialog=!1}}},[t._v("Close")]),s("v-spacer"),t.cancelOrderFail.visible||t.cancelOrderSuccess.visible?t._e():s("v-btn",{staticClass:"cancel-order-btn",attrs:{text:""},on:{click:t.cancelOrder}},[t._v("Delete")]),t.cancelOrderFail.visible?s("v-btn",{staticClass:"cancel-order-btn",attrs:{text:""},on:{click:t.cancelOrder}},[t._v("Try Again")]):t._e()],1)],1)],1),s("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.orders,"item-key":"id","hide-default-footer":""},scopedSlots:t._u([{key:"item",fn:function(e){var i=e.item;return[s("tr",[s("td",[t._v(t._s(i.vintage)+"  "+t._s(i.producer))]),s("td",{staticClass:"text-xs-right"},[t._v(t._s(i.region))]),s("td",{staticClass:"text-xs-right"},[t._v(t._s(i.size)+"l")]),s("td",{staticClass:"text-xs-right"},[t._v(t._s(i.orderType))]),s("td",{staticClass:"text-xs-right"},[t._v(t._s(i.units))]),s("td",{staticClass:"text-xs-right"},[t._v("€"+t._s(i.price))]),s("td",{staticClass:"text-xs-right"},[t._v(t._s(t.orderStatuses[i.orderStatus]))]),s("td",{staticClass:"justify-center layout px-0"},[s("v-btn",{staticClass:"order-modify-btn",attrs:{text:"",color:"primary"},on:{click:function(e){return t.openOrder(i)}}},[s("v-icon",{attrs:{left:""}},[t._v("mdi-pencil")])],1),s("v-btn",{staticClass:"order-cancel-btn",attrs:{text:"",color:"primary"},on:{click:function(e){return t.openCancelDialog(i.id)}}},[s("v-icon",{attrs:{left:""}},[t._v("mdi-close-circle")])],1)],1)])]}}])},[s("template",{slot:"no-data"},[s("v-alert",{staticClass:"no-orders-info",attrs:{dense:"",type:"info"}},[t._v("There are no orders.")])],1)],2)],1)},n=[],a=i("a34a"),r=i.n(a),o=i("2f62"),l=i("63e0"),c=i("94d5"),u=i("604d");function d(t,e,i,s,n,a,r){try{var o=t[a](r),l=o.value}catch(c){return void i(c)}o.done?e(l):Promise.resolve(l).then(s,n)}function m(t){return function(){var e=this,i=arguments;return new Promise(function(s,n){var a=t.apply(e,i);function r(t){d(a,s,n,r,o,"next",t)}function o(t){d(a,s,n,r,o,"throw",t)}r(void 0)})}}function f(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,s)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(i,!0).forEach(function(e){_(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function _(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b={name:"Orders",components:{IntegerPlusminus:u["a"]},data:function(){return{modifyOrderDialog:!1,cancelOrderDialog:!1,cancelOrderID:null,cancelOrderSuccess:{visible:!1,text:"Order was cancelled successfully!"},cancelOrderFail:{visible:!1,text:"Order cancellation failed!"},editOrderSuccess:{visible:!1,text:"Order was saved successfully!"},editOrderFail:{visible:!1,text:"Order update failed!"},headers:[{text:"Wine",align:"left",sortable:!1,value:"producer"},{text:"Region",value:"region"},{text:"Size",value:"size"},{text:"Type",value:"type"},{text:"Units",value:"units"},{text:"Price",value:"price"},{text:"Status",value:"status",sortable:!1},{text:"",sortable:!1}],orderStatuses:{1:"Pending",2:"Filled",3:"Edited",4:"PartiallyFilled",5:"Cancelled"},units:0,price:0}},computed:v({maxUnits:function(){var t=this,e=1e3;if("OFFER"===this.selectedOrder.orderType){var i=this.portfolio.find(function(e){return t.selectedOrder.wineId==e.wine.wineId});if(i){for(var s=i.units,n=0;n<this.orders.length;n++)this.selectedOrder.wineId==this.orders[n].wineId&&this.selectedOrder.id!=this.orders[n].id&&(s-=this.orders[n].units);e=s}}return e}},Object(o["c"])({orders:c["e"].GET_BIDS_AND_OFFERS,portfolio:c["f"].GET_PORTFOLIO_WINE_LIST,selectedOrder:c["e"].GET_ACTIVE_ORDER,wineDetails:c["h"].GET_SELECTED_WINE_INFO})),created:function(){this.getOrders(),this.getPortfolio()},methods:v({openOrder:function(t){this.selectOrder(t),this.getWineDetails(t),this.modifyOrderDialog=!0},openCancelDialog:function(t){this.cancelOrderID=t,this.cancelOrderDialog=!0},cancelOrder:function(){var t=m(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.cancelOrderAsync(this.cancelOrderID).then(function(){e.cancelOrderFail.visible=!1,e.cancelOrderSuccess.visible=!0});case 2:this.getOrders();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),editOrder:function(){var t=this;this.saveOrder({units:this.units,price:this.price}).then(function(e){e.succeeded?(t.editOrderFail.visible=!1,t.editOrderSuccess.visible=!0,t.getOrders()):t.editOrderFail.visible=!0})}},Object(o["b"])({getOrders:l["e"].GET_ORDERS,selectOrder:l["e"].SET_ACTIVE_ORDER,getWineDetails:l["h"].GET_WINE_DETAILS,cancelOrderAsync:l["e"].CANCEL_ORDER,getPortfolio:l["f"].GET_PORTFOLIO,saveOrder:l["e"].SAVE_ORDER})),watch:{selectedOrder:{immediate:!0,deep:!0,handler:function(t){this.price=t.price,this.units=t.units}}}},h=b,p=(i("68b6"),i("761d"),i("2877")),C=Object(p["a"])(h,s,n,!1,null,"224332a8",null);e["a"]=C.exports},ee4a:function(t,e,i){},f905:function(t,e,i){}}]);
//# sourceMappingURL=chunk-4eaa9127.0edf8d63.js.map